<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Full Screen Clock</title>
    <style>
        /* CSS ‡¶ï‡ßã‡¶° */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            width: 100%;
            background: #000000;
            color: #ffffff;
            font-family: 'Roboto Mono', monospace;
            overflow: hidden;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶™‡¶™-‡¶Ü‡¶™ */
        #settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(30, 30, 30, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #settings-box {
            background: #ffffff;
            color: #333;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 450px;
            font-family: Arial, sans-serif;
            max-height: 90vh;
            overflow-y: auto;
        }

        #settings-box h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #007bff;
        }

        .setting-item {
            margin-bottom: 15px;
        }
        .setting-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .setting-item input[type="checkbox"] + label {
            display: inline-block;
            font-weight: normal;
        }

        /* ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶ü */
        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }
        .color-box {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .color-box.selected { border-color: #007bff; }

        /* ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        input[type="color"], select, button, input[type="range"] {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            margin-top: 5px;
        }
        input[type="range"] { padding: 0; }
        input[type="color"] { height: 40px; padding: 4px; }
        
        #start-clock-btn {
            background-color: #007bff;
            color: white;
            font-weight: bold;
            border: none;
            cursor: pointer;
            padding: 12px;
            margin-top: 20px;
            font-size: 1.1em;
        }
        #start-clock-btn:hover { background-color: #0056b3; }

        /* ‡¶Æ‡ßÇ‡¶≤ ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá */
        #clock-display {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: grab;
        }

        /* ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡¶ø ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ */
        #battery-status {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 2.5vmin;
            display: none; /* ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã */
            z-index: 50;
        }
        
        /* ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶®‡¶§‡ßÅ‡¶® vmin ‡¶∏‡¶æ‡¶á‡¶ú‡¶ø‡¶Ç) */
        #digital-clock-container {
            display: flex;
            align-items: baseline;
            justify-content: center;
        }
        #time {
            /* * vmin ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá (Viewport Minimum)
             * ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶• ‡¶¨‡¶æ ‡¶â‡¶ö‡ßç‡¶ö‡¶§‡¶æ, ‡¶Ø‡ßá‡¶ü‡¶ø ‡¶õ‡ßã‡¶ü, ‡¶§‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡¶∏‡¶æ‡¶á‡¶ú ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá‡•§
             * ‡¶§‡¶æ‡¶á ‡¶´‡¶®‡ßç‡¶ü ‡¶Ü‡¶∞ ‡¶ï‡¶ñ‡¶®‡ßã‡¶á ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§
            */
            font-size: 25vmin; 
            font-weight: bold;
            line-height: 1;
            transition: font-size 0.1s ease-out;
            white-space: nowrap;
        }
        #ampm {
            font-size: 6vmin; /* ‡¶Ü‡¶®‡ßÅ‡¶™‡¶æ‡¶§‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶õ‡ßã‡¶ü */
            font-weight: normal;
            margin-left: 2vw;
            align-self: flex-end;
        }
        #date {
            font-size: 7vmin; /* ‡¶Ü‡¶®‡ßÅ‡¶™‡¶æ‡¶§‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶õ‡ßã‡¶ü */
            margin-top: 10px;
            text-align: center;
        }

        /* * ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤‡¶ø‡¶∂ ‡¶è‡¶®‡¶æ‡¶≤‡¶ó ‡¶ò‡ßú‡¶ø
        */
        #analog-clock {
            width: 70vmin;
            height: 70vmin;
            border: 10px solid; /* ‡¶∞‡¶Ç ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá */
            border-radius: 50%;
            position: relative;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.5);
            display: none;
            color: inherit; /* ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶∞‡¶ô ‡¶™‡¶æ‡¶¨‡ßá */
        }
        
        /* ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶≠‡ßá‡¶§‡¶∞‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ (‡ßß-‡ßß‡ß®) */
        .number {
            position: absolute;
            width: 100%;
            height: 100%;
            text-align: center;
            font-size: 5vmin;
            font-weight: bold;
            padding-top: 2.5vmin; /* ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶≠‡ßá‡¶§‡¶∞‡ßá‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶Ü‡¶®‡¶æ */
        }
        /* ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¶‡¶ø‡ßü‡ßá ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ò‡ßã‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá */
        
        /* ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶Å‡¶ü‡¶æ */
        .hand {
            position: absolute;
            left: 50%;
            transform-origin: bottom center;
            background-color: currentColor;
            border-radius: 2px;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        #hour-hand {
            width: 1.8%;
            height: 30%;
            top: 20%;
            margin-left: -0.9%;
        }
        #minute-hand {
            width: 1.2%;
            height: 40%;
            top: 10%;
            margin-left: -0.6%;
        }
        #second-hand {
            width: 0.6%;
            height: 45%;
            top: 5%;
            margin-left: -0.3%;
            background-color: #FF4500; /* ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° ‡¶≤‡¶æ‡¶≤ */
        }
        #center-dot {
            width: 4%;
            height: 4%;
            background-color: currentColor;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        
        /* ‡¶´‡¶®‡ßç‡¶ü ‡¶™‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞ */
        .font-roboto-mono { font-family: 'Roboto Mono', monospace; }
        .font-orbitron { font-family: 'Orbitron', sans-serif; }
        .font-digital-7 { font-family: 'Digital-7', sans-serif; }
        
        /* ‡¶¨‡ßç‡¶∞‡¶æ‡¶á‡¶ü‡¶®‡ßá‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ */
        #main-display-wrapper {
            width: 100%;
            height: 100%;
            transition: filter 0.3s ease;
        }
        #main-display-wrapper.dim-0 { filter: brightness(0%); }
        #main-display-wrapper.dim-25 { filter: brightness(25%); }
        #main-display-wrapper.dim-50 { filter: brightness(50%); }
        #main-display-wrapper.dim-75 { filter: brightness(75%); }
        #main-display-wrapper.dim-100 { filter: brightness(100%); }

    </style>
</head>
<body>

    <div id="settings-overlay">
        <div id="settings-box">
            <h2>Clock Settings</h2>
            
            <div class="setting-item">
                <label for="clock-color">‡ßß. ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü:</label>
                <div class="color-palette">
                    <div class="color-box" style="background-color: #FFFFFF;" data-color="#FFFFFF"></div>
                    <div class="color-box" style="background-color: #00BFFF;" data-color="#00BFFF"></div> 
                    <div class="color-box" style="background-color: #32CD32;" data-color="#32CD32"></div> 
                    <div class="color-box" style="background-color: #FF4500;" data-color="#FF4500"></div> 
                    <div class="color-box" style="background-color: #DA70D6;" data-color="#DA70D6"></div> 
                    <div class="color-box" style="background-color: #FFFF00;" data-color="#FFFF00"></div> 
                </div>
                <input type="color" id="clock-color" value="#FFFFFF">
            </div>
            
            <div class="setting-item">
                <label for="time-source">‡ß®. ‡¶∏‡¶Æ‡ßü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®:</label>
                <select id="time-source">
                    <option value="device">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∏‡¶Æ‡ßü (Device Time)</option>
                    <option value="network">‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡ßü (Network Time)</option>
                </select>
            </div>
            
            <div class="setting-item">
                <label for="clock-type">‡ß©. ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶ß‡¶∞‡¶®:</label>
                <select id="clock-type">
                    <option value="digital">‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ (Digital)</option>
                    <option value="analog">‡¶è‡¶®‡¶æ‡¶≤‡¶ó (Analog)</option>
                </select>
            </div>

            <div class="setting-item">
                <label for="clock-font">‡ß™. ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶´‡¶®‡ßç‡¶ü (‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤):</label>
                <select id="clock-font">
                    <option value="Roboto Mono">Roboto Mono</option>
                    <option value="Orbitron">Orbitron</option>
                    <option value="Digital-7">Digital-7</option>
                </select>
            </div>
            
            <div class="setting-item">
                <label for="brightness-range">‡ß´. ‡¶â‡¶ú‡ßç‡¶ú‡ßç‡¶¨‡¶≤‡¶§‡¶æ (Brightness):</label>
                <input type="range" id="brightness-range" min="0" max="100" value="100" step="25">
                <span id="brightness-value">100%</span>
            </div>
            
            <div class="setting-item">
                <input type="checkbox" id="show-date" checked>
                <label for="show-date">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶® (‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶Æ‡ßã‡¶°)</label>
            </div>
            
            <div class="setting-item">
                <input type="checkbox" id="show-battery" checked>
                <label for="show-battery">‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡¶ø ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶® (‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞‡¶ø‡¶∂)</label>
            </div>

            <button id="start-clock-btn">OK</button>
        </div>
    </div>

    <div id="main-display-wrapper">
        <div id="clock-display">
            <div id="battery-status"></div>

            <div id="digital-clock-container">
                <div id="time">00:00:00</div>
                <div id="ampm">AM</div>
            </div>
            <div id="date">Date</div>

            <div id="analog-clock">
                <div id="hour-hand" class="hand"></div>
                <div id="minute-hand" class="hand"></div>
                <div id="second-hand" class="hand"></div>
                <div id="center-dot"></div>
                </div>
        </div>
    </div>

    <script>
        // JavaScript ‡¶ï‡ßã‡¶°
        
        // DOM ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü
        const settingsOverlay = document.getElementById('settings-overlay');
        const startBtn = document.getElementById('start-clock-btn');
        const clockDisplay = document.getElementById('clock-display');
        const displayWrapper = document.getElementById('main-display-wrapper');
        const batteryStatusEl = document.getElementById('battery-status');

        // ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶ï‡ßç‡¶≤‡¶ï
        const digitalClockContainer = document.getElementById('digital-clock-container');
        const timeEl = document.getElementById('time');
        const ampmEl = document.getElementById('ampm');
        const dateEl = document.getElementById('date');

        // ‡¶è‡¶®‡¶æ‡¶≤‡¶ó ‡¶ï‡ßç‡¶≤‡¶ï
        const analogClock = document.getElementById('analog-clock');
        const hourHand = document.getElementById('hour-hand');
        const minuteHand = document.getElementById('minute-hand');
        const secondHand = document.getElementById('second-hand');

        // ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü
        const colorInput = document.getElementById('clock-color');
        const colorPalette = document.querySelector('.color-palette');
        const timeSourceSelect = document.getElementById('time-source');
        const showDateCheckbox = document.getElementById('show-date');
        const showBatteryCheckbox = document.getElementById('show-battery');
        const clockTypeSelect = document.getElementById('clock-type');
        const clockFontSelect = document.getElementById('clock-font');
        const brightnessRange = document.getElementById('brightness-range');
        const brightnessValueSpan = document.getElementById('brightness-value');

        // ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡ßü‡ßá‡¶¨‡¶≤
        let clockInterval;
        let timeOffset = 0;
        let currentFontSize = 25; // ‡¶´‡¶®‡ßç‡¶ü ‡¶ú‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶∏‡¶æ‡¶á‡¶ú (vmin)
        
        // === ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞: Wake Lock (‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶∏‡¶ú‡¶æ‡¶ó ‡¶∞‡¶æ‡¶ñ‡¶æ) ===
        let screenWakeLock = null;

        // Wake Lock ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const requestWakeLock = async () => {
            if ('wakeLock' in navigator) {
                try {
                    screenWakeLock = await navigator.wakeLock.request('screen');
                    console.log('Screen Wake Lock is active.');
                } catch (err) {
                    console.error(`${err.name}, ${err.message}`);
                }
            } else {
                console.warn('Wake Lock API is not supported in this browser.');
            }
        };

        // Wake Lock ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const releaseWakeLock = () => {
            if (screenWakeLock !== null) {
                screenWakeLock.release();
                screenWakeLock = null;
                console.log('Screen Wake Lock released.');
            }
        };

        // === ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞: ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡¶ø ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ===
        let batteryManager = null;
        
        const updateBatteryStatus = (battery) => {
            if (showBatteryCheckbox.checked) {
                batteryStatusEl.style.display = 'block';
                const level = (battery.level * 100).toFixed(0);
                const chargingStatus = battery.charging ? '(Charging) üîå' : '(Discharging) üîã';
                batteryStatusEl.textContent = `${level}% ${chargingStatus}`;
            } else {
                batteryStatusEl.style.display = 'none';
            }
        };
        
        const initBatteryMonitor = async () => {
            if ('getBattery' in navigator) {
                try {
                    batteryManager = await navigator.getBattery();
                    updateBatteryStatus(batteryManager);
                    batteryManager.addEventListener('chargingchange', () => updateBatteryStatus(batteryManager));
                    batteryManager.addEventListener('levelchange', () => updateBatteryStatus(batteryManager));
                } catch (err) {
                    console.error('Battery Status API error:', err);
                }
            } else {
                console.warn('Battery Status API not supported.');
            }
        };

        const stopBatteryMonitor = () => {
            if (batteryManager) {
                batteryManager.removeEventListener('chargingchange', () => updateBatteryStatus(batteryManager));
                batteryManager.removeEventListener('levelchange', () => updateBatteryStatus(batteryManager));
                batteryManager = null;
                batteryStatusEl.style.display = 'none';
            }
        };

        // === ‡¶è‡¶®‡¶æ‡¶≤‡¶ó ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ===
        function createAnalogClockFace() {
            // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá)
            analogClock.querySelectorAll('.number').forEach(n => n.remove());
            
            for (let i = 1; i <= 12; i++) {
                const numberEl = document.createElement('div');
                numberEl.classList.add('number');
                numberEl.textContent = i;
                // ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶æ‡¶ï‡¶æ‡¶∞‡ßá ‡¶ò‡ßã‡¶∞‡¶æ‡¶®‡ßã
                numberEl.style.transform = `rotate(${i * 30}deg)`;
                analogClock.appendChild(numberEl);
            }
        }

        // Local Storage ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        function loadSettings() {
            const savedColor = localStorage.getItem('clockColor') || '#FFFFFF';
            const savedTimeSource = localStorage.getItem('timeSource') || 'device';
            const savedShowDate = localStorage.getItem('showDate') === 'true';
            const savedShowBattery = localStorage.getItem('showBattery') === 'true';
            const savedClockType = localStorage.getItem('clockType') || 'digital';
            const savedClockFont = localStorage.getItem('clockFont') || 'Roboto Mono';
            const savedBrightness = localStorage.getItem('brightness') || '100';

            colorInput.value = savedColor;
            timeSourceSelect.value = savedTimeSource;
            showDateCheckbox.checked = savedShowDate;
            showBatteryCheckbox.checked = savedShowBattery;
            clockTypeSelect.value = savedClockType;
            clockFontSelect.value = savedClockFont;
            brightnessRange.value = savedBrightness;
            brightnessValueSpan.textContent = savedBrightness + '%';
            
            updateColorPaletteSelection(savedColor);
            displayWrapper.className = `dim-${savedBrightness}`;
        }
        
        // ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ
        colorPalette.addEventListener('click', (event) => {
            const clickedBox = event.target.closest('.color-box');
            if (clickedBox) {
                const color = clickedBox.dataset.color;
                colorInput.value = color;
                updateColorPaletteSelection(color);
            }
        });

        function updateColorPaletteSelection(selectedColor) {
            document.querySelectorAll('.color-box').forEach(box => {
                box.classList.toggle('selected', box.dataset.color === selectedColor);
            });
        }
        
        // ‡¶â‡¶ú‡ßç‡¶ú‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞
        brightnessRange.addEventListener('input', () => {
            const brightness = brightnessRange.value;
            brightnessValueSpan.textContent = brightness + '%';
            displayWrapper.className = `dim-${brightness}`;
            localStorage.setItem('brightness', brightness);
        });


        // OK ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá
        startBtn.addEventListener('click', async () => {
            // ‡ßß. ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶™‡ßú‡¶æ ‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ
            const selectedColor = colorInput.value;
            const timeSource = timeSourceSelect.value;
            const showDate = showDateCheckbox.checked;
            const showBattery = showBatteryCheckbox.checked;
            const clockType = clockTypeSelect.value;
            const clockFont = clockFontSelect.value;
            const currentBrightness = brightnessRange.value;

            localStorage.setItem('clockColor', selectedColor);
            localStorage.setItem('timeSource', timeSource);
            localStorage.setItem('showDate', showDate);
            localStorage.setItem('showBattery', showBattery);
            localStorage.setItem('clockType', clockType);
            localStorage.setItem('clockFont', clockFont);
            localStorage.setItem('brightness', currentBrightness);

            // ‡ß®. ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ
            applyClockSettings(selectedColor, showDate, clockType, clockFont, showBattery);
            
            // ‡ß©. ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú ‡¶ï‡¶∞‡¶æ (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á)
            timeOffset = 0;
            if (timeSource === 'network') {
                try {
                    const response = await fetch('https://worldtimeapi.org/api/ip');
                    const data = await response.json();
                    const serverTime = new Date(data.utc_datetime).getTime();
                    const localTime = new Date().getTime();
                    timeOffset = serverTime - localTime;
                } catch (error) {
                    console.error('Failed to fetch network time:', error);
                    alert('‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡ßü ‡¶Ü‡¶®‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∏‡¶Æ‡ßü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§');
                }
            }

            // ‡ß™. ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Æ‡ßá‡¶®‡ßÅ ‡¶π‡¶æ‡¶á‡¶° ‡¶ï‡¶∞‡¶æ
            settingsOverlay.style.display = 'none';

            // ‡ß´. ‡¶´‡ßÅ‡¶≤-‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶∏‡ßç‡¶ï‡ßá‡¶™ ‡¶Æ‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ
            requestFullScreen();
            lockLandscape();
            
            // === ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßÅ ===
            await requestWakeLock(); // ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶∏‡¶ú‡¶æ‡¶ó ‡¶∞‡¶æ‡¶ñ‡¶æ
            if (showBattery) {
                initBatteryMonitor(); // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßÅ
            }

            // ‡ß¨. ‡¶ò‡ßú‡¶ø ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ
            startClock();
        });

        // ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function applyClockSettings(color, showDate, clockType, font, showBattery) {
            clockDisplay.style.color = color;
            batteryStatusEl.style.display = showBattery ? 'block' : 'none';

            // ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
            const fontClass = font.toLowerCase().replace(' ', '-');
            timeEl.className = `font-${fontClass}`;
            dateEl.className = `font-${fontClass}`;

            // ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶ß‡¶∞‡¶® (‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤/‡¶è‡¶®‡¶æ‡¶≤‡¶ó)
            if (clockType === 'digital') {
                digitalClockContainer.style.display = 'flex';
                dateEl.style.display = showDate ? 'block' : 'none';
                analogClock.style.display = 'none';
            } else {
                digitalClockContainer.style.display = 'none';
                dateEl.style.display = 'none';
                analogClock.style.display = 'block';
                analogClock.style.borderColor = color; // ‡¶è‡¶®‡¶æ‡¶≤‡¶ó ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞
            }
        }

        // ‡¶ò‡ßú‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function updateClock() {
            const now = new Date(new Date().getTime() + timeOffset);

            // ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶ò‡ßú‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            let hours = now.getHours();
            const minutes = padZero(now.getMinutes());
            const seconds = padZero(now.getSeconds());
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12;
            
            timeEl.textContent = `${padZero(hours)}:${minutes}:${seconds}`;
            ampmEl.textContent = ampm;
            dateEl.textContent = now.toLocaleDateString('en-US', {
                weekday: 'long', month: 'long', day: 'numeric', year: 'numeric'
            });

            // ‡¶è‡¶®‡¶æ‡¶≤‡¶ó ‡¶ò‡ßú‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            const sec = now.getSeconds();
            const min = now.getMinutes();
            const hr = now.getHours();
            
            const secDeg = (sec / 60) * 360;
            const minDeg = (min / 60) * 360 + (sec / 60) * 6;
            const hrDeg = (hr / 12) * 360 + (min / 60) * 30;
            
            // CSS ‡¶è 90deg ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶Ö‡¶´‡¶∏‡ßá‡¶ü ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶á ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡ßá‡¶á 
            // *‡¶∏‡¶Ç‡¶∂‡ßã‡¶ß‡¶®: ‡¶Ü‡¶Æ‡¶æ‡¶∞ CSS ‡¶è 0deg (‡¶∏‡ßã‡¶ú‡¶æ ‡¶â‡¶™‡¶∞‡ßá) ‡¶ï‡ßá 12‡¶ü‡¶æ ‡¶ß‡¶∞‡ßá ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡¶®‡¶ø, ‡¶§‡¶æ‡¶á 90deg ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
            // *‡¶™‡ßÅ‡¶®‡¶É ‡¶∏‡¶Ç‡¶∂‡ßã‡¶ß‡¶®: ‡¶ï‡¶æ‡¶Å‡¶ü‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã CSS ‡¶è `top` ‡¶¶‡¶ø‡ßü‡ßá ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá, ‡¶§‡¶æ‡¶á 0deg ‡¶π‡¶≤‡ßã 12‡¶ü‡¶æ‡•§ 90deg ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá ‡¶®‡¶æ‡•§
            // *‡¶ö‡ßÇ‡ßú‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡¶Ç‡¶∂‡ßã‡¶ß‡¶®: `transform-origin: bottom center` ‡¶¶‡¶ø‡ßü‡ßá‡¶õ‡¶ø, ‡¶§‡¶æ‡¶á 0deg ‡¶π‡¶≤‡ßã 6‡¶ü‡¶æ‡•§ 180deg ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
            // ‡¶®‡¶æ, ‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá ‡¶∏‡¶π‡¶ú ‡¶â‡¶™‡¶æ‡ßü ‡¶π‡¶≤‡ßã ‡¶ï‡¶æ‡¶Å‡¶ü‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá 12‡¶ü‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶ñ ‡¶ï‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ (top: 50%, height: 50%) ‡¶è‡¶¨‡¶Ç 0deg ‡¶ï‡ßá 12‡¶ü‡¶æ ‡¶ß‡¶∞‡¶æ‡•§
            // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® CSS ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ (top: 10% ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø), 0deg ‡¶π‡¶≤‡ßã 6‡¶ü‡¶æ‡•§
            // *‡¶∏‡¶π‡¶ú ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®:* ‡¶ï‡¶æ‡¶Å‡¶ü‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ CSS `transform` ‡¶è `rotate(Xdeg)` ‡¶è‡¶∞ ‡¶¨‡¶¶‡¶≤‡ßá JS ‡¶•‡ßá‡¶ï‡ßá `transform: rotate(Xdeg)` ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨‡ßã‡•§
            
            // ‡¶ï‡¶æ‡¶Å‡¶ü‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã 12‡¶ü‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶ñ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶õ‡ßá (‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü) ‡¶ß‡¶∞‡ßá ‡¶®‡¶ø‡ßü‡ßá:
            const secDegJS = (sec / 60) * 360;
            const minDegJS = (min / 60) * 360 + (sec / 60) * 6;
            const hrDegJS = (hr / 12) * 360 + (min / 60) * 30;

            secondHand.style.transform = `rotate(${secDegJS}deg)`;
            minuteHand.style.transform = `rotate(${minDegJS}deg)`;
            hourHand.style.transform = `rotate(${hrDegJS}deg)`;
        }

        // ‡¶ò‡ßú‡¶ø ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ (‡ßß ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶™‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü)
        function startClock() {
            if (clockInterval) clearInterval(clockInterval);
            updateClock();
            clockInterval = setInterval(updateClock, 1000);
        }

        function padZero(num) {
            return num < 10 ? '0' + num : num;
        }

        // --- ‡¶´‡ßÅ‡¶≤-‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶∏‡ßç‡¶ï‡ßá‡¶™ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---
        function requestFullScreen() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen();
            else if (elem.mozRequestFullScreen) elem.mozRequestFullScreen();
            else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
            else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
        }
        function lockLandscape() {
            try {
                if (screen.orientation && screen.orientation.lock) {
                    screen.orientation.lock('landscape').catch(err => console.warn(err));
                }
            } catch (error) {
                console.warn('Screen orientation lock not supported.', error);
            }
        }

        // --- ‡¶°‡¶æ‡¶¨‡¶≤-‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∞‡¶ø-‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡¶æ ---
        clockDisplay.addEventListener('dblclick', () => {
            settingsOverlay.style.display = 'flex';
            if (clockInterval) clearInterval(clockInterval);
            if (document.exitFullscreen) document.exitFullscreen();
            if (screen.orientation && screen.orientation.unlock) screen.orientation.unlock();
            
            // === ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ ===
            releaseWakeLock(); // Wake Lock ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ
            stopBatteryMonitor(); // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ

            loadSettings();
            displayWrapper.className = ''; // ‡¶¨‡ßç‡¶∞‡¶æ‡¶á‡¶ü‡¶®‡ßá‡¶∏ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü
        });

        // --- ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶ï‡¶∞‡ßá ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ---
        clockDisplay.addEventListener('wheel', (event) => {
            event.preventDefault();
            if (clockTypeSelect.value === 'digital') {
                const zoomFactor = 1; // ‡¶ú‡ßÅ‡¶Æ ‡¶∏‡ßç‡¶™‡¶ø‡¶° (vmin)
                if (event.deltaY < 0) {
                    currentFontSize = Math.min(35, currentFontSize + zoomFactor); // ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö 35vmin
                } else {
                    currentFontSize = Math.max(10, currentFontSize - zoomFactor); // ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® 10vmin
                }
                // ‡¶®‡¶§‡ßÅ‡¶® vmin ‡¶∏‡¶æ‡¶á‡¶ú ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ
                timeEl.style.fontSize = `${currentFontSize}vmin`;
                ampmEl.style.fontSize = `${currentFontSize / 4}vmin`;
                dateEl.style.fontSize = `${currentFontSize / 3.5}vmin`;
            }
        });
        
        // ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™
        loadSettings();
        createAnalogClockFace(); // ‡¶è‡¶®‡¶æ‡¶≤‡¶ó ‡¶ò‡ßú‡¶ø‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ
        
    </script>
</body>
</html>
